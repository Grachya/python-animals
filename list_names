documents = [
        {"type": "passport", "number": "2207 876234", "name": "Василий Гупкин"},
        {"type": "invoice", "number": "11-2", "name": "Геннадий Покемонов"},
        {"type": "insurance", "number": "10006", "name": "Аристарх Павлов"}
      ]

directories = {
        '1': ['2207 876234', '11-2'],
        '2': ['10006'],
        '3': []
      }

command = input('Введите одну из следующих команд p, l, s, a, d, m, as, ln: ')

def get_name_by_number():
  """
  Find and print document owner name by document number
  """
  number = input('Введите номер документа: ')
  for document in documents:
    if document['number'] == number:
      print('Документ с номером {} пренадлежит - {}'.format(number, document['name']))
      break
  else:
    print('Документ с таким номером не существует')

def list_documents():
  """
  List all documents
  """
  if len(documents) != 0:
    print('Список всех документов: ')
    for document in documents:
      print(document['type'], document['number'], document['name'])
  else:
    print('Список документов пустой.')

def find_shelf_by_document_number():
  """
  Find shelf by document number
  """
  number = input('Введите номер документа: ')
  for shelf in directories:
    if directories[shelf].count(number) > 0:
      print('Документ находится на полке {}'.format(shelf))
      break
  else:
    print('Такого документа нет на полках.')

def add_document():
  """
  Add new documet and put on shelfe
  """
  doc_type = input('Введите тип документа: ')
  doc_number = input('Введите номер документа: ')
  doc_name = input('Введите имя владельца документы: ')
  document = {"type": doc_type, "number": doc_number, "name": doc_name}
  doc_shelfe = input('Введите полку (От 1 до 3) на которой будет документ: ')

  incorrect_shelfe = 1 > int(doc_shelfe) or int(doc_shelfe) > 3

  while incorrect_shelfe:
    if incorrect_shelfe:
      print('Вы выбрали не верную полку.', doc_shelfe)
      doc_shelfe = input('Введите полку (От 1 до 3) на которой будет документ: ')
      incorrect_shelfe = 1 > int(doc_shelfe) or int(doc_shelfe) > 3

  directories[doc_shelfe].append(doc_number)
  documents.append(document)
  print('Документ добавлен.')

def remove_from_directories(number):
  """
  Remove document from dictionary
  """
  for shelf in directories:
    if directories[shelf].count(number) > 0:
      directories[shelf].remove(number)
      break
  else:
    print('Документа {} на полке не оказалось'.format(number))

def delete_document():
  """
  Delete document by number
  """
  doc_number = input('Введите номер документа для удаления: ')
  
  for k, document in enumerate(documents):
    if document['number'] == doc_number:
      documents.remove(document)
      remove_from_directories(doc_number)
      print('Документ {} удален'.format(doc_number))
      break
  else:
    print('Такого документы не существует.')

def move_document_to_shelf():
  """
  Move document to another shelf by number
  """
  doc_number = input('Введите номер документа для перемещения: ')
  target_shelf = input('Введите номер полки для перемещения документа #{}: '.format(doc_number))

  if not doc_number or not target_shelf:
    print('Неверно введены данные')
    return

  directories_keys = directories.keys()
  if list(directories_keys).count(target_shelf) > 0:
    for shelf in directories:
      if directories[shelf].count(doc_number) >0:
        directories[shelf].remove(doc_number)
        directories[target_shelf].append(doc_number)
        print('Документ # {} перемещен на полку {}'.format(doc_number, target_shelf))
        break
  else:
    print('Полки {} не существует.'.format(target_shelf))  

def add_shelf():
  """
  Add new shelf
  """
  shelf_number = input('Введите номер полки для добавления: ')

  if not shelf_number:
    print('Вы ничего не ввели')
    return

  directories_keys = directories.keys()

  if list(directories_keys).count(shelf_number) > 0:
    print('Такая полка уже существует.')
  else:
    directories[shelf_number] = []
    print('Новая полка #{} добавлена.'.format(shelf_number))

def list_name():
  """
  list all documents name
  """
   for document in documents:
    try:
      print(document['name'])
    except KeyError:
      print('У документа {} нет ключа name'.format(document))

if command.lower() == 'p':
  get_name_by_number()
elif command.lower() == 'l':
  list_documents()
elif command.lower() == 's':
  find_shelf_by_document_number()
elif command.lower() == 'a':
  add_document()
elif command.lower() == 'd':
  delete_document()
elif command.lower() == 'm':
  move_document_to_shelf()
elif command.lower() == 'as':
  add_shelf()
elif command.lower() == 'ln':
  list_name()
else:
  print('Неверная команда')
